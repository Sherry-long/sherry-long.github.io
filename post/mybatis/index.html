<!doctype html>
<html lang="en-us">
  <head>
    <title>MyBatis // Sp(act)rum</title>
    <link rel="shortcut icon" href="/favicon.ico" />
    <meta charset="utf-8" />
    <meta name="generator" content="Hugo 0.80.0" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="冯雪洋" />
    <meta name="description" content="" />
    <link rel="stylesheet" href="https://sherry-long.github.io/css/main.min.88e7083eff65effb7485b6e6f38d10afbec25093a6fac42d734ce9024d3defbd.css" />

    
    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="MyBatis"/>
<meta name="twitter:description" content="​	一、MyBatis简介
​	二、搭建MyBatis
​	三、核心配置文件详解
​	四、MyBatis获取参数值的两种方式
​	五、MyBatis的各种查询功能
​	六、特殊SQL的执行
​	七、自定义映射resultMap
​	八、动态SQL
#
一、MyBatis简介 1. MyBatis特性   MyBatis是支持定制化SQL、存储过程以及高级映射的优秀的持久层框架
  MyBatis避免了几乎所有的 JDBC代码和手动设置参数以及获取结果集
  MyBatis可以使用简单的XML或注解用于配置和原始映射，将接口和Java的POJO（Plain Old Java Objects，普通的Java对象）映射成数据库中的记录
  MyBatis 是一个半自动的ORM（Object Relation Mapping）框架
    #
二、搭建MyBatis 打包方式：jar 引入依赖 &lt;!-- MySQL驱动 --&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;version&gt;8.0.31&lt;/version&gt; &lt;/dependency&gt; &lt;!-- MyBatis核心 --&gt; &lt;dependency&gt; &lt;groupId&gt;org.mybatis&lt;/groupId&gt; &lt;artifactId&gt;mybatis&lt;/artifactId&gt; &lt;version&gt;3.5.11&lt;/version&gt; &lt;/dependency&gt; &lt;!-- Junit --&gt; &lt;dependency&gt; &lt;groupId&gt;junit&lt;/groupId&gt; &lt;artifactId&gt;junit&lt;/artifactId&gt; &lt;version&gt;4.13.2&lt;/version&gt; &lt;/dependency&gt; 创建MyBatis核心配置文件 习惯上命名为mybatis-config."/>

    <meta property="og:title" content="MyBatis" />
<meta property="og:description" content="​	一、MyBatis简介
​	二、搭建MyBatis
​	三、核心配置文件详解
​	四、MyBatis获取参数值的两种方式
​	五、MyBatis的各种查询功能
​	六、特殊SQL的执行
​	七、自定义映射resultMap
​	八、动态SQL
#
一、MyBatis简介 1. MyBatis特性   MyBatis是支持定制化SQL、存储过程以及高级映射的优秀的持久层框架
  MyBatis避免了几乎所有的 JDBC代码和手动设置参数以及获取结果集
  MyBatis可以使用简单的XML或注解用于配置和原始映射，将接口和Java的POJO（Plain Old Java Objects，普通的Java对象）映射成数据库中的记录
  MyBatis 是一个半自动的ORM（Object Relation Mapping）框架
    #
二、搭建MyBatis 打包方式：jar 引入依赖 &lt;!-- MySQL驱动 --&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;version&gt;8.0.31&lt;/version&gt; &lt;/dependency&gt; &lt;!-- MyBatis核心 --&gt; &lt;dependency&gt; &lt;groupId&gt;org.mybatis&lt;/groupId&gt; &lt;artifactId&gt;mybatis&lt;/artifactId&gt; &lt;version&gt;3.5.11&lt;/version&gt; &lt;/dependency&gt; &lt;!-- Junit --&gt; &lt;dependency&gt; &lt;groupId&gt;junit&lt;/groupId&gt; &lt;artifactId&gt;junit&lt;/artifactId&gt; &lt;version&gt;4.13.2&lt;/version&gt; &lt;/dependency&gt; 创建MyBatis核心配置文件 习惯上命名为mybatis-config." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://sherry-long.github.io/post/mybatis/" />
<meta property="article:published_time" content="2022-11-21T15:22:53+08:00" />
<meta property="article:modified_time" content="2022-11-21T15:22:53+08:00" />


  </head>
  <body>
    <header class="app-header">
      <a href="https://sherry-long.github.io/"><img class="app-header-avatar" src="/avatar.jpg" alt="冯雪洋" /></a>
      <h1>Sp(act)rum</h1>
      <p>这个人很懒，什么介绍都没留下</p>
      <div class="app-header-social">
        
          <a target="_blank" href="https://github.com/Sherry-long" rel="noreferrer noopener"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github">
  <title>github</title>
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
</svg></a>
        
          <a target="_blank" href="https://space.bilibili.com/13547597" rel="noreferrer noopener"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-link">
  <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
  <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
</svg></a>
        
      </div>
    </header>
    <main class="app-container">
      
  <article class="post">
    <header class="post-header">
      <h1 class ="post-title">MyBatis</h1>
      <div class="post-meta">
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar">
  <title>calendar</title>
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line>
</svg>
          Nov 21, 2022
        </div>
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock">
  <title>clock</title>
  <circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>
</svg>
          9 min read
        </div>
      </div>
    </header>
    <div class="post-content">
      <p>​	<a href="#Intro">一、MyBatis简介</a></p>
<p>​	<a href="#Build">二、搭建MyBatis</a></p>
<p>​	<a href="#config">三、核心配置文件详解</a></p>
<p>​	<a href="#getParam">四、MyBatis获取参数值的两种方式</a></p>
<p>​	<a href="#MyBatisQuery">五、MyBatis的各种查询功能</a></p>
<p>​	<a href="#SpecialSQL">六、特殊SQL的执行</a></p>
<p>​	<a href="#resultMap">七、自定义映射resultMap</a></p>
<p>​	<a href="#DynamicSQL">八、动态SQL</a></p>
<p><a id="Intro">#</a></p>
<h3 id="一mybatis简介">一、MyBatis简介</h3>
<h4 id="1-mybatis特性">1. MyBatis特性</h4>
<ul>
<li>
<p>MyBatis是支持定制化SQL、存储过程以及高级映射的优秀的持久层框架</p>
</li>
<li>
<p>MyBatis避免了几乎所有的 JDBC代码和手动设置参数以及获取结果集</p>
</li>
<li>
<p>MyBatis可以使用简单的XML或注解用于配置和原始映射，将接口和Java的POJO（Plain Old Java Objects，普通的Java对象）映射成数据库中的记录</p>
</li>
<li>
<p>MyBatis 是一个半自动的ORM（Object Relation Mapping）框架</p>
</li>
</ul>
<hr>
<hr>
<p><a id="Build">#</a></p>
<h3 id="二搭建mybatis">二、搭建MyBatis</h3>
<h4 id="打包方式jar">打包方式：jar</h4>
<h4 id="引入依赖">引入依赖</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;!-- MySQL驱动 --&gt;</span>
        <span style="color:#f92672">&lt;dependency&gt;</span>
            <span style="color:#f92672">&lt;groupId&gt;</span>mysql<span style="color:#f92672">&lt;/groupId&gt;</span>
            <span style="color:#f92672">&lt;artifactId&gt;</span>mysql-connector-java<span style="color:#f92672">&lt;/artifactId&gt;</span>
            <span style="color:#f92672">&lt;version&gt;</span>8.0.31<span style="color:#f92672">&lt;/version&gt;</span>
        <span style="color:#f92672">&lt;/dependency&gt;</span>
    
<span style="color:#75715e">&lt;!-- MyBatis核心 --&gt;</span>
        <span style="color:#f92672">&lt;dependency&gt;</span>
            <span style="color:#f92672">&lt;groupId&gt;</span>org.mybatis<span style="color:#f92672">&lt;/groupId&gt;</span>
            <span style="color:#f92672">&lt;artifactId&gt;</span>mybatis<span style="color:#f92672">&lt;/artifactId&gt;</span>
            <span style="color:#f92672">&lt;version&gt;</span>3.5.11<span style="color:#f92672">&lt;/version&gt;</span>
        <span style="color:#f92672">&lt;/dependency&gt;</span>
    
<span style="color:#75715e">&lt;!-- Junit --&gt;</span>
        <span style="color:#f92672">&lt;dependency&gt;</span>
            <span style="color:#f92672">&lt;groupId&gt;</span>junit<span style="color:#f92672">&lt;/groupId&gt;</span>
            <span style="color:#f92672">&lt;artifactId&gt;</span>junit<span style="color:#f92672">&lt;/artifactId&gt;</span>
            <span style="color:#f92672">&lt;version&gt;</span>4.13.2<span style="color:#f92672">&lt;/version&gt;</span>
        <span style="color:#f92672">&lt;/dependency&gt;</span>
</code></pre></div><h4 id="创建mybatis核心配置文件">创建MyBatis核心配置文件</h4>
<p>习惯上命名为mybatis-config.xml。主要用于配置连接数据库的环境以及MyBatis的全局配置信息</p>
<p>存放位置 src/main/resources 目录下</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
<span style="color:#75715e">&lt;!DOCTYPE configuration
</span><span style="color:#75715e">        PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34;
</span><span style="color:#75715e">        &#34;http://mybatis.org/dtd/mybatis-3-config.dtd&#34;&gt;</span>

<span style="color:#f92672">&lt;configuration&gt;</span>
    <span style="color:#75715e">&lt;!--设置连接数据库的环境--&gt;</span>
    <span style="color:#f92672">&lt;environments</span> <span style="color:#a6e22e">default=</span><span style="color:#e6db74">&#34;development&#34;</span><span style="color:#f92672">&gt;</span>
        <span style="color:#f92672">&lt;environment</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;development&#34;</span><span style="color:#f92672">&gt;</span>
            <span style="color:#f92672">&lt;transactionManager</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;JDBC&#34;</span><span style="color:#f92672">/&gt;</span>
            <span style="color:#f92672">&lt;dataSource</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;POOLED&#34;</span><span style="color:#f92672">&gt;</span>
                <span style="color:#f92672">&lt;property</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;driver&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;com.mysql.cj.jdbc.Driver&#34;</span><span style="color:#f92672">/&gt;</span>
                <span style="color:#f92672">&lt;property</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;url&#34;</span>
                          <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;jdbc:mysql://localhost:3306/mybatis&#34;</span><span style="color:#f92672">/&gt;</span>
                <span style="color:#f92672">&lt;property</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;username&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;root&#34;</span><span style="color:#f92672">/&gt;</span>
                <span style="color:#f92672">&lt;property</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;password&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;root&#34;</span><span style="color:#f92672">/&gt;</span>
            <span style="color:#f92672">&lt;/dataSource&gt;</span>
        <span style="color:#f92672">&lt;/environment&gt;</span>
    <span style="color:#f92672">&lt;/environments&gt;</span>
    <span style="color:#75715e">&lt;!--引入映射文件--&gt;</span>
    <span style="color:#f92672">&lt;mappers&gt;</span>
        <span style="color:#f92672">&lt;mapper</span> <span style="color:#a6e22e">resource=</span><span style="color:#e6db74">&#34;mappers/UserMapper.xml&#34;</span><span style="color:#f92672">/&gt;</span>
    <span style="color:#f92672">&lt;/mappers&gt;</span>
<span style="color:#f92672">&lt;/configuration&gt;</span>
</code></pre></div><h4 id="创建mapper接口">创建mapper接口</h4>
<p>MyBatis中的mapper接口相当于以前的dao。但是区别在于，mapper仅仅是接口，我们不需要提供实现类。</p>
<p>MyBatis支持面向接口编程，当我们通过接口调用方法时，MyBatis就会自动去匹配对应的SQL语句</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">UserMapper</span> <span style="color:#f92672">{</span>
    <span style="color:#75715e">/**
</span><span style="color:#75715e">     * 添加用户信息
</span><span style="color:#75715e">     */</span>
    <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">insertUser</span><span style="color:#f92672">();</span>
<span style="color:#f92672">}</span>
</code></pre></div><h4 id="创建mybatis映射文件">创建MyBatis映射文件</h4>
<p><strong>ORM</strong>(<strong>O</strong>bject <strong>R</strong>elationship <strong>M</strong>apping)对象关系映射</p>
<ul>
<li>对象：Java实体类对象</li>
<li>关系：关系型数据库</li>
<li>映射：二者之间的对应关系</li>
</ul>
<table>
<thead>
<tr>
<th>Java概念</th>
<th>数据库概念</th>
</tr>
</thead>
<tbody>
<tr>
<td>类</td>
<td>表</td>
</tr>
<tr>
<td>属性</td>
<td>字段/列</td>
</tr>
<tr>
<td>对象</td>
<td>记录/行</td>
</tr>
</tbody>
</table>
<p>1、映射文件的命名规则：</p>
<p>表所对应的实体类的类名+Mapper.xml</p>
<p>例如表t_user，映射的实体类为User，所对应的映射文件为UserMapper.xml</p>
<p>因此一个映射文件对应一个实体类，对应一张表的操作</p>
<p>MyBatis映射文件用于编写SQL，访问以及操作表中的数据</p>
<p>MyBatis映射文件存放的位置是src/main/resources/mappers目录下</p>
<p>2、MyBatis中可以面向接口操作数据，要保证<strong>两个一致</strong>：</p>
<p>a&gt; mapper接口的全类名和映射文件的命名空间（namespace）保持一致</p>
<p>b&gt; mapper接口中方法的方法名和映射文件中编写SQL的标签的id属性保持一致</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
<span style="color:#75715e">&lt;!DOCTYPE mapper
</span><span style="color:#75715e">    PUBLIC &#34;-//mybatis.org//DTD Mapper 3.0//EN&#34;
</span><span style="color:#75715e">    &#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd&#34;&gt;</span>
<span style="color:#f92672">&lt;mapper</span> <span style="color:#a6e22e">namespace=</span><span style="color:#e6db74">&#34;com.sherry.MyBatis.mapper.UserMapper&#34;</span><span style="color:#f92672">&gt;</span>

    <span style="color:#75715e">&lt;!--int insertUser();--&gt;</span>
    <span style="color:#f92672">&lt;insert</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;insertUser&#34;</span><span style="color:#f92672">&gt;</span>
        insert into t_user values(null, &#39;admin&#39;, &#39;123456&#39;, 23, &#39;男&#39;, &#39;1234@123.com&#39;)
    <span style="color:#f92672">&lt;/insert&gt;</span>
<span style="color:#f92672">&lt;/mapper&gt;</span>
</code></pre></div><h4 id="junit测试功能">Junit测试功能</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">//读取MyBatis的核心配置文件
</span><span style="color:#75715e"></span>InputStream is <span style="color:#f92672">=</span> Resources<span style="color:#f92672">.</span><span style="color:#a6e22e">getResourceAsStream</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;mybatis_config.xml&#34;</span><span style="color:#f92672">);</span>

<span style="color:#75715e">//创建SqlSessionFactoryBuilder对象
</span><span style="color:#75715e"></span>SqlSessionFactoryBuilder sqlSessionFactoryBuilder <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span>
SqlSessionFactoryBuilder<span style="color:#f92672">();</span>

<span style="color:#75715e">//通过核心配置文件所对应的字节输入流创建工厂类SqlSessionFactory，生产SqlSession对象
</span><span style="color:#75715e"></span>SqlSessionFactory sqlSessionFactory <span style="color:#f92672">=</span> sqlSessionFactoryBuilder<span style="color:#f92672">.</span><span style="color:#a6e22e">build</span><span style="color:#f92672">(</span>is<span style="color:#f92672">);</span>

<span style="color:#75715e">//创建SqlSession对象，此时通过SqlSession对象所操作的sql都必须手动提交或回滚事务
</span><span style="color:#75715e">//SqlSession sqlSession = sqlSessionFactory.openSession();
</span><span style="color:#75715e">//创建SqlSession对象，此时通过SqlSession对象所操作的sql都会自动提交
</span><span style="color:#75715e">//sqlSession默认不自动提交事务，设置参数为true自动提交事务
</span><span style="color:#75715e"></span>SqlSession sqlSession <span style="color:#f92672">=</span> sqlSessionFactory<span style="color:#f92672">.</span><span style="color:#a6e22e">openSession</span><span style="color:#f92672">(</span><span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>

<span style="color:#75715e">//通过代理模式创建UserMapper接口的代理实现类对象
</span><span style="color:#75715e"></span>UserMapper userMapper <span style="color:#f92672">=</span> sqlSession<span style="color:#f92672">.</span><span style="color:#a6e22e">getMapper</span><span style="color:#f92672">(</span>UserMapper<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">);</span>

<span style="color:#75715e">//调用UserMapper接口中的方法，就可以根据UserMapper的全类名匹配元素文件，通过调用的方法名匹配
</span><span style="color:#75715e">//映射文件中的SQL标签，并执行标签中的SQL语句
</span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> result <span style="color:#f92672">=</span> userMapper<span style="color:#f92672">.</span><span style="color:#a6e22e">insertUser</span><span style="color:#f92672">();</span>

<span style="color:#75715e">//sqlSession参数不设置为true，则需要手动提交事务
</span><span style="color:#75715e">//sqlSession.commit();
</span><span style="color:#75715e"></span>System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;result:&#34;</span> <span style="color:#f92672">+</span> result<span style="color:#f92672">);</span>
</code></pre></div><ul>
<li>SqlSession：代表Java程序和数据库之间的会话</li>
<li>SqlSessionFactory：生产 SqlSession 的工厂</li>
<li>工厂模式：如果创建某一个对象，使用的过程基本固定，那么我们就可以把创建这个对象的相关代码封装到一个“工厂类”中，以后都使用这个工厂类来“生产”我们需要的对象。</li>
</ul>
<h4 id="加入log4j日志功能">加入log4j日志功能</h4>
<p><strong>a&gt;加入依赖</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#f92672">&lt;dependency&gt;</span>
    <span style="color:#f92672">&lt;groupId&gt;</span>log4j<span style="color:#f92672">&lt;/groupId&gt;</span>
    <span style="color:#f92672">&lt;artifactId&gt;</span>log4j<span style="color:#f92672">&lt;/artifactId&gt;</span>
    <span style="color:#f92672">&lt;version&gt;</span>1.2.17<span style="color:#f92672">&lt;/version&gt;</span>
<span style="color:#f92672">&lt;/dependency&gt;</span>
</code></pre></div><p><strong>b&gt;加入log4j的配置文件</strong></p>
<p>log4j的配置文件名为log4j.xml，存放的位置是src/main/resources目录下</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
<span style="color:#75715e">&lt;!DOCTYPE log4j:configuration SYSTEM &#34;log4j.dtd&#34;&gt;</span>
<span style="color:#f92672">&lt;log4j:configuration</span> <span style="color:#a6e22e">xmlns:log4j=</span><span style="color:#e6db74">&#34;http://jakarta.apache.org/log4j/&#34;</span><span style="color:#f92672">&gt;</span>
    <span style="color:#f92672">&lt;appender</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;STDOUT&#34;</span> <span style="color:#a6e22e">class=</span><span style="color:#e6db74">&#34;org.apache.log4j.ConsoleAppender&#34;</span><span style="color:#f92672">&gt;</span>
        <span style="color:#f92672">&lt;param</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;Encoding&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;UTF-8&#34;</span> <span style="color:#f92672">/&gt;</span>
        <span style="color:#f92672">&lt;layout</span> <span style="color:#a6e22e">class=</span><span style="color:#e6db74">&#34;org.apache.log4j.PatternLayout&#34;</span><span style="color:#f92672">&gt;</span>
            <span style="color:#f92672">&lt;param</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;ConversionPattern&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;%-5p %d{MM-dd HH:mm:ss,SSS} %m (%F:%L) \n&#34;</span> <span style="color:#f92672">/&gt;</span>
        <span style="color:#f92672">&lt;/layout&gt;</span>
    <span style="color:#f92672">&lt;/appender&gt;</span>
    <span style="color:#f92672">&lt;logger</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;java.sql&#34;</span><span style="color:#f92672">&gt;</span>
        <span style="color:#f92672">&lt;level</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;debug&#34;</span> <span style="color:#f92672">/&gt;</span>
    <span style="color:#f92672">&lt;/logger&gt;</span>
    <span style="color:#f92672">&lt;logger</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;org.apache.ibatis&#34;</span><span style="color:#f92672">&gt;</span>
        <span style="color:#f92672">&lt;level</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;info&#34;</span> <span style="color:#f92672">/&gt;</span>
    <span style="color:#f92672">&lt;/logger&gt;</span>
    <span style="color:#f92672">&lt;root&gt;</span>
        <span style="color:#f92672">&lt;level</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;debug&#34;</span> <span style="color:#f92672">/&gt;</span>
        <span style="color:#f92672">&lt;appender-ref</span> <span style="color:#a6e22e">ref=</span><span style="color:#e6db74">&#34;STDOUT&#34;</span> <span style="color:#f92672">/&gt;</span>
    <span style="color:#f92672">&lt;/root&gt;</span>
<span style="color:#f92672">&lt;/log4j:configuration&gt;</span>
</code></pre></div><p><strong>日志的级别</strong></p>
<p>FATAL(致命) &gt; ERROR(错误) &gt; WARN(警告) &gt; INFO(信息) &gt; DEBUG(调试)</p>
<p>从左到右打印内容越来越详细</p>
<h4 id="修改和删除功能">修改和删除功能</h4>
<p>使用MyBatis框架时，当我们需要新增功能时，现在对应的mapper接口中声明方法，再在对应的映射文件中编写对应的标签以及sql语句</p>
<p><strong>修改</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">UserMapper</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">insertUser</span><span style="color:#f92672">();</span>

    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">updateUser</span><span style="color:#f92672">();</span>
<span style="color:#f92672">}</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;!--void updateUser();--&gt;</span>
<span style="color:#f92672">&lt;update</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;updateUser&#34;</span><span style="color:#f92672">&gt;</span>
    update t_user set username=&#39;somebody&#39;,email=&#39;sb@123.com&#39; where id=6
<span style="color:#f92672">&lt;/update&gt;</span>
</code></pre></div><p><strong>删除</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">UserMapper</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">insertUser</span><span style="color:#f92672">();</span>

    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">updateUser</span><span style="color:#f92672">();</span>

    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">deleteUser</span><span style="color:#f92672">();</span>
<span style="color:#f92672">}</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;!--void deleteUser();--&gt;</span>
<span style="color:#f92672">&lt;delete</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;deleteUser&#34;</span><span style="color:#f92672">&gt;</span>
    delete from t_user where username=&#39;小美&#39;
<span style="color:#f92672">&lt;/delete&gt;</span>
</code></pre></div><p><strong>查找一个实体类对象</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">UserMapper</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">insertUser</span><span style="color:#f92672">();</span>

    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">updateUser</span><span style="color:#f92672">();</span>

    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">deleteUser</span><span style="color:#f92672">();</span>

    User <span style="color:#a6e22e">getUserById</span><span style="color:#f92672">();</span>
<span style="color:#f92672">}</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;!--User getUserById();--&gt;</span>
<span style="color:#f92672">&lt;select</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;getUserById&#34;</span> <span style="color:#a6e22e">resultType=</span><span style="color:#e6db74">&#34;com.sherry.MyBatis.pojo.User&#34;</span><span style="color:#f92672">&gt;</span>
    select * from t_user where id = 4
<span style="color:#f92672">&lt;/select&gt;</span>
</code></pre></div><p><strong>查找集合</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;!--List&lt;User&gt; getAllUsers();--&gt;</span>
<span style="color:#f92672">&lt;select</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;getAllUsers&#34;</span> <span style="color:#a6e22e">resultType=</span><span style="color:#e6db74">&#34;com.sherry.MyBatis.pojo.User&#34;</span><span style="color:#f92672">&gt;</span>
    select * from t_user
<span style="color:#f92672">&lt;/select&gt;</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">InputStream is <span style="color:#f92672">=</span> Resources<span style="color:#f92672">.</span><span style="color:#a6e22e">getResourceAsStream</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;mybatis_config.xml&#34;</span><span style="color:#f92672">);</span>
SqlSessionFactory sqlSessionFactory <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> SqlSessionFactoryBuilder<span style="color:#f92672">().</span><span style="color:#a6e22e">build</span><span style="color:#f92672">(</span>is<span style="color:#f92672">);</span>
SqlSession sqlSession <span style="color:#f92672">=</span> sqlSessionFactory<span style="color:#f92672">.</span><span style="color:#a6e22e">openSession</span><span style="color:#f92672">(</span><span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
UserMapper mapper <span style="color:#f92672">=</span> sqlSession<span style="color:#f92672">.</span><span style="color:#a6e22e">getMapper</span><span style="color:#f92672">(</span>UserMapper<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">);</span>
<span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span>User user <span style="color:#f92672">:</span> mapper<span style="color:#f92672">.</span><span style="color:#a6e22e">getAllUsers</span><span style="color:#f92672">())</span> <span style="color:#f92672">{</span>
    System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span>user<span style="color:#f92672">);</span>
<span style="color:#f92672">}</span>

<span style="color:#75715e">/*输出：
</span><span style="color:#75715e">DEBUG 11-22 16:28:35,708 ==&gt;  Preparing: select * from t_user (BaseJdbcLogger.java:137) 
</span><span style="color:#75715e">DEBUG 11-22 16:28:35,747 ==&gt; Parameters:  (BaseJdbcLogger.java:137) 
</span><span style="color:#75715e">DEBUG 11-22 16:28:35,778 &lt;==      Total: 3 (BaseJdbcLogger.java:137) 
</span><span style="color:#75715e">User{id=4, username=&#39;Jamyoung&#39;, password=&#39;qwert&#39;, age=23, gender=&#39;男&#39;, email=&#39;JY@123.com&#39;}
</span><span style="color:#75715e">User{id=6, username=&#39;somebody&#39;, password=&#39;1457345&#39;, age=23, gender=&#39;男&#39;, email=&#39;sb@123.com&#39;}
</span><span style="color:#75715e">User{id=7, username=&#39;admin&#39;, password=&#39;1457345&#39;, age=23, gender=&#39;男&#39;, email=&#39;admin@123.com&#39;}
</span><span style="color:#75715e"> */</span>
</code></pre></div><p><strong>注意：</strong></p>
<ol>
<li>查询标签select<strong>必须设置属性resultType或resultMap</strong>，用于设置实体类和数据库表的映射关系</li>
</ol>
<p>resultType：自动映射，用于属性名和表中字段名一致的情况</p>
<p>resultMap：自定义映射，用于一对多或多对一或字段名和属性名不一致的情况</p>
<ol start="2">
<li>当查询的数据为多条时，使用集合作为返回类型，若只有一条，实体类和集合<strong>都可以</strong>作为返回类型</li>
</ol>
<hr>
<hr>
<p><a id="config">#</a></p>
<h3 id="三核心配置文件详解">三、核心配置文件详解</h3>
<p>核心配置文件中的标签必须按照固定的顺序：</p>
<p><strong>properties?,settings?,typeAliases?,typeHandlers?,objectFactory?,objectWrapperFactory?,reflectorF actory?,plugins?,environments?,databaseIdProvider?,mappers?</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
<span style="color:#75715e">&lt;!DOCTYPE configuration
</span><span style="color:#75715e">PUBLIC &#34;-//MyBatis.org//DTD Config 3.0//EN&#34;
</span><span style="color:#75715e">&#34;http://MyBatis.org/dtd/MyBatis-3-config.dtd&#34;&gt;</span>
<span style="color:#f92672">&lt;configuration&gt;</span>
    <span style="color:#75715e">&lt;!--引入properties文件，此时就可以${属性名}的方式访问属性值--&gt;</span>
    <span style="color:#f92672">&lt;properties</span> <span style="color:#a6e22e">resource=</span><span style="color:#e6db74">&#34;jdbc.properties&#34;</span><span style="color:#f92672">&gt;&lt;/properties&gt;</span>
    
    <span style="color:#f92672">&lt;settings&gt;</span>
        <span style="color:#75715e">&lt;!--将表中字段的下划线自动转换为驼峰--&gt;</span>
        <span style="color:#f92672">&lt;setting</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;mapUnderscoreToCamelCase&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;true&#34;</span><span style="color:#f92672">/&gt;</span>
        <span style="color:#75715e">&lt;!--开启延迟加载--&gt;</span>
        <span style="color:#f92672">&lt;setting</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;lazyLoadingEnabled&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;true&#34;</span><span style="color:#f92672">/&gt;</span>
    <span style="color:#f92672">&lt;/settings&gt;</span>
    
    <span style="color:#f92672">&lt;typeAliases&gt;</span>
        <span style="color:#75715e">&lt;!--
</span><span style="color:#75715e">            typeAlias：设置某个具体的类型的别名
</span><span style="color:#75715e">            属性：
</span><span style="color:#75715e">            type：需要设置别名的类型的全类名
</span><span style="color:#75715e">            alias：设置此类型的别名，如果不设置属性alias，默认使用类名作为别名，且不区分大小写
</span><span style="color:#75715e">            	若设置此属性，此时该类型的别名只能使用alias所设置的值
</span><span style="color:#75715e">        --&gt;</span>
        <span style="color:#f92672">&lt;typeAlias</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;com.sherry.MyBatis.pojo.User&#34;</span><span style="color:#f92672">/&gt;</span>
        <span style="color:#75715e">&lt;!--以包为单位，设置该包下所有的类型都拥有默认的别名，即类名且不区分大小写--&gt;</span>
        <span style="color:#f92672">&lt;package</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;com.sherry.MyBatis.pojo&#34;</span><span style="color:#f92672">/&gt;</span>
    <span style="color:#f92672">&lt;/typeAliases&gt;</span>
    
    <span style="color:#75715e">&lt;!--
</span><span style="color:#75715e">        environments：设置多个连接数据库的环境
</span><span style="color:#75715e">        属性：
</span><span style="color:#75715e">        default：设置默认使用的环境的id
</span><span style="color:#75715e">    --&gt;</span>
    <span style="color:#f92672">&lt;environments</span> <span style="color:#a6e22e">default=</span><span style="color:#e6db74">&#34;mysql_test&#34;</span><span style="color:#f92672">&gt;</span>
        <span style="color:#75715e">&lt;!--
</span><span style="color:#75715e">            environment：设置具体的连接数据库的环境信息
</span><span style="color:#75715e">            属性：
</span><span style="color:#75715e">            id：设置环境的唯一标识，可通过environments标签中的default设置某一个环境的id，表示默认使用的环境
</span><span style="color:#75715e">        --&gt;</span>
        <span style="color:#f92672">&lt;environment</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;mysql_test&#34;</span><span style="color:#f92672">&gt;</span>
            <span style="color:#75715e">&lt;!--
</span><span style="color:#75715e">                transactionManager：设置事务管理方式
</span><span style="color:#75715e">                属性：
</span><span style="color:#75715e">                type：设置事务管理方式，type=&#34;JDBC|MANAGED&#34;
</span><span style="color:#75715e">                type=&#34;JDBC&#34;：设置当前环境的事务管理都必须手动处理
</span><span style="color:#75715e">                type=&#34;MANAGED&#34;：设置事务被管理，例如spring中的AOP
</span><span style="color:#75715e">            --&gt;</span>
            <span style="color:#f92672">&lt;transactionManager</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;JDBC&#34;</span><span style="color:#f92672">/&gt;</span>
            <span style="color:#75715e">&lt;!--
</span><span style="color:#75715e">                dataSource：设置数据源
</span><span style="color:#75715e">                属性：
</span><span style="color:#75715e">                type：设置数据源的类型，type=&#34;POOLED|UNPOOLED|JNDI&#34;
</span><span style="color:#75715e">                type=&#34;POOLED&#34;：使用数据库连接池，即会将创建的连接进行缓存，下次使用可以从缓存中直接获取，不需要重新创建
</span><span style="color:#75715e">                type=&#34;UNPOOLED&#34;：不使用数据库连接池，即每次使用连接都需要重新创建
</span><span style="color:#75715e">                type=&#34;JNDI&#34;：调用上下文中的数据源
</span><span style="color:#75715e">            --&gt;</span>
            <span style="color:#f92672">&lt;dataSource</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;POOLED&#34;</span><span style="color:#f92672">&gt;</span>
                <span style="color:#75715e">&lt;!--设置驱动类的全类名--&gt;</span>
                <span style="color:#f92672">&lt;property</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;driver&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;${jdbc.driver}&#34;</span><span style="color:#f92672">/&gt;</span>
                <span style="color:#75715e">&lt;!--设置连接数据库的连接地址--&gt;</span>
                <span style="color:#f92672">&lt;property</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;url&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;${jdbc.url}&#34;</span><span style="color:#f92672">/&gt;</span>
                <span style="color:#75715e">&lt;!--设置连接数据库的用户名--&gt;</span>
                <span style="color:#f92672">&lt;property</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;username&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;${jdbc.username}&#34;</span><span style="color:#f92672">/&gt;</span>
                <span style="color:#75715e">&lt;!--设置连接数据库的密码--&gt;</span>
                <span style="color:#f92672">&lt;property</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;password&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;${jdbc.password}&#34;</span><span style="color:#f92672">/&gt;</span>
            <span style="color:#f92672">&lt;/dataSource&gt;</span>
        <span style="color:#f92672">&lt;/environment&gt;</span>
    <span style="color:#f92672">&lt;/environments&gt;</span>
    
    <span style="color:#75715e">&lt;!--引入映射文件--&gt;</span>
    <span style="color:#f92672">&lt;mappers&gt;</span>
<span style="color:#75715e">&lt;!--        &lt;mapper resource=&#34;mappers/UserMapper.xml&#34;/&gt;--&gt;</span>
        <span style="color:#75715e">&lt;!--
</span><span style="color:#75715e">            以包为单位，将包下所有的映射文件引入核心配置文件
</span><span style="color:#75715e">			在resources下创建包应使用 \ 进行目录分割
</span><span style="color:#75715e">            注意：此方式必须保证mapper接口和mapper映射文件包名一致
</span><span style="color:#75715e">                且接口与映射文件名一致
</span><span style="color:#75715e">        --&gt;</span>
        <span style="color:#f92672">&lt;package</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;com.sherry.MyBatis.mapper&#34;</span><span style="color:#f92672">/&gt;</span>
    <span style="color:#f92672">&lt;/mappers&gt;</span>
<span style="color:#f92672">&lt;/configuration&gt;</span>
</code></pre></div><hr>
<hr>
<p><a id="getParam">#</a></p>
<h3 id="四mybatis获取参数值的两种方式">四、MyBatis获取参数值的两种方式</h3>
<p>MyBatis获取参数值的两种方式：<strong>${}</strong> 和 <strong>#{}</strong></p>
<p>**${}<strong>本质是字符串拼接，</strong>#{}**本质是占位符赋值</p>
<p>**${}<strong>使用字符串拼接的方式拼接sql，若为字符串类型或日期类型的字段进行赋值时，需要手动加单引 号；但是</strong>#{}**使用占位符赋值的方式拼接sql，此时为字符串类型或日期类型的字段进行赋值时，可以自动添加单引号</p>
<h4 id="1-单个字面量类型的参数">1. 单个字面量类型的参数</h4>
<p>若mapper接口中的方法参数为单个的字面量类型</p>
<p>此时可以使用**${}**和**#{}**以任意的名称获取参数的值，注意**${}**需要手动加单引号</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;!--User getUser(Integer id);--&gt;</span>
<span style="color:#f92672">&lt;select</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;getUser&#34;</span> <span style="color:#a6e22e">resultType=</span><span style="color:#e6db74">&#34;User&#34;</span><span style="color:#f92672">&gt;</span>
    select * from t_user where id = #{id}
    <span style="color:#75715e">&lt;!--此处参数名无限制，任意参数名都可获取参数值--&gt;</span>
<span style="color:#f92672">&lt;/select&gt;</span>
</code></pre></div><h4 id="2-多个字面量类型的参数">2. 多个字面量类型的参数</h4>
<p>若mapper接口中的方法参数为多个时</p>
<p>此时MyBatis会自动将这些参数放在一个map集合中，以**arg0,arg1&hellip;**为键，以参数为值；以 **param1,param2&hellip;<strong>为键，以参数为值；因此只需要通过</strong>${}<strong>和</strong>#{}<strong>访问map集合的键就可以获取相对应的 值，注意</strong>${}**需要手动加单引号</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;!--User checkLogin(String username, String password);--&gt;</span>
<span style="color:#f92672">&lt;select</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;checkLogin&#34;</span> <span style="color:#a6e22e">resultType=</span><span style="color:#e6db74">&#34;User&#34;</span><span style="color:#f92672">&gt;</span>
    select * from t_user where username = #{param1} and password = #{param2}
    <span style="color:#75715e">&lt;!--(arg0, arg1), (arg0, param2) 写法都可以--&gt;</span>
<span style="color:#f92672">&lt;/select&gt;</span>
</code></pre></div><h4 id="3-map集合类型的参数">3. map集合类型的参数</h4>
<p>若mapper接口中的方法需要的参数为多个时</p>
<p>此时可以手动创建map集合，将这些数据放在map中 只需要通过**${}**和**#{}**访问map集合的键就可以获取相对应的值，注意**${}**需要手动加单引号</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">Map<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">,</span> Object<span style="color:#f92672">&gt;</span> map <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> HashMap<span style="color:#f92672">&lt;&gt;();</span>
map<span style="color:#f92672">.</span><span style="color:#a6e22e">put</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;username&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;admin&#34;</span><span style="color:#f92672">);</span>
map<span style="color:#f92672">.</span><span style="color:#a6e22e">put</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;password&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;1457345&#34;</span><span style="color:#f92672">);</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;!--User checkLogin(Map&lt;String, Object&gt; map);--&gt;</span>
<span style="color:#f92672">&lt;select</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;checkLogin&#34;</span> <span style="color:#a6e22e">resultType=</span><span style="color:#e6db74">&#34;User&#34;</span><span style="color:#f92672">&gt;</span>
    select * from t_user where username = #{username} and password = #{password}
<span style="color:#f92672">&lt;/select&gt;</span>
</code></pre></div><h4 id="4-实体类类型的参数">4. 实体类类型的参数</h4>
<p>若mapper接口中的方法参数为实体类对象时</p>
<p>此时可以使用**${}**和**#{}**，通过访问实体类对象中的属性名获取属性值，注意**${}**需要手动加单引号</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;!--void insertUser(User user);--&gt;</span>
<span style="color:#f92672">&lt;insert</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;insertUser&#34;</span><span style="color:#f92672">&gt;</span>
    insert into t_user values (#{id}, #{username},
                                #{password}, #{age},
                                #{gender}, #{email})
<span style="color:#f92672">&lt;/insert&gt;</span>
</code></pre></div><p><strong>注：实体类中如果有getters和setters，默认会调用getters、setters对属性进行赋值取值；如果实体类中没有。MyBatis会通过反射来直接访问访问对象的属性</strong></p>
<h4 id="5-使用param标识参数">5. 使用@Param标识参数</h4>
<p>可以通过**@Param**注解标识mapper接口中的方法参数</p>
<p>此时，会将这些参数放在map集合中，以**@Param**注解的value属性值为键，以参数为值；以 **param1,param2&hellip;**为键，以参数为值；只需要通过**${}**和**#{}**访问map集合的键就可以获取相对应的值， 注意**${}**需要手动加单引号</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">User <span style="color:#a6e22e">checkLogin</span><span style="color:#f92672">(</span><span style="color:#a6e22e">@Param</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;username&#34;</span><span style="color:#f92672">)</span> String username<span style="color:#f92672">,</span> <span style="color:#a6e22e">@Param</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;password&#34;</span><span style="color:#f92672">)</span> String password<span style="color:#f92672">);</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;!--User checkLogin(@Param(&#34;username&#34;) String username, @Param(&#34;password&#34;) String password);--&gt;</span>
<span style="color:#f92672">&lt;select</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;checkLogin&#34;</span> <span style="color:#a6e22e">resultType=</span><span style="color:#e6db74">&#34;User&#34;</span><span style="color:#f92672">&gt;</span>
    select * from t_user where username = #{username} and password = #{password}
<span style="color:#f92672">&lt;/select&gt;</span>
</code></pre></div><hr>
<hr>
<p><a id="MyBatisQuery">#</a></p>
<h3 id="五mybatis的各种查询功能">五、MyBatis的各种查询功能</h3>
<h4 id="1-查询一个实体类对象">1. 查询一个实体类对象</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">/**
</span><span style="color:#75715e">* 根据用户id查询用户信息
</span><span style="color:#75715e">* @param id
</span><span style="color:#75715e">* @return
</span><span style="color:#75715e">*/</span>
User <span style="color:#a6e22e">getUserById</span><span style="color:#f92672">(</span><span style="color:#a6e22e">@Param</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;id&#34;</span><span style="color:#f92672">)</span> <span style="color:#66d9ef">int</span> id<span style="color:#f92672">);</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;!--User getUserById(@Param(&#34;id&#34;) int id);--&gt;</span>
<span style="color:#f92672">&lt;select</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;getUserById&#34;</span> <span style="color:#a6e22e">resultType=</span><span style="color:#e6db74">&#34;User&#34;</span><span style="color:#f92672">&gt;</span>
    select * from t_user where id = #{id}
<span style="color:#f92672">&lt;/select&gt;</span>
</code></pre></div><h4 id="2-查询一个list集合">2. 查询一个list集合</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">/**
</span><span style="color:#75715e">* 查询所有用户信息
</span><span style="color:#75715e">* @return
</span><span style="color:#75715e">*/</span>
List<span style="color:#f92672">&lt;</span>User<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">getUserList</span><span style="color:#f92672">();</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;!--List&lt;User&gt; getUserList();--&gt;</span>
<span style="color:#f92672">&lt;select</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;getUserList&#34;</span> <span style="color:#a6e22e">resultType=</span><span style="color:#e6db74">&#34;User&#34;</span><span style="color:#f92672">&gt;</span>
    select * from t_user
<span style="color:#f92672">&lt;/select&gt;</span>
</code></pre></div><h4 id="3-查询单个数据">3. 查询单个数据</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">/**
</span><span style="color:#75715e">* 查询用户的总记录数
</span><span style="color:#75715e">* @return
</span><span style="color:#75715e">* 在MyBatis中，对于Java中常用的类型都设置了类型别名
</span><span style="color:#75715e">* 例如：java.lang.Integer--&gt;int|integer
</span><span style="color:#75715e">* 例如：int--&gt;_int|_integer
</span><span style="color:#75715e">* 例如：Map--&gt;map,List--&gt;list
</span><span style="color:#75715e">* 例如：String--&gt;string
</span><span style="color:#75715e">*/</span>
<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">getCount</span><span style="color:#f92672">();</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;!--int getCount();--&gt;</span>
<span style="color:#f92672">&lt;select</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;getCount&#34;</span> <span style="color:#a6e22e">resultType=</span><span style="color:#e6db74">&#34;_integer&#34;</span><span style="color:#f92672">&gt;</span>
    select count(id) from t_user
<span style="color:#f92672">&lt;/select&gt;</span>
</code></pre></div><h4 id="4-查询一条数据为map集合">4. 查询一条数据为map集合</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">/**
</span><span style="color:#75715e">* 根据用户id查询用户信息为map集合
</span><span style="color:#75715e">* @param id
</span><span style="color:#75715e">* @return
</span><span style="color:#75715e">*/</span>
Map<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">,</span> Object<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">getUserToMap</span><span style="color:#f92672">(</span><span style="color:#a6e22e">@Param</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;id&#34;</span><span style="color:#f92672">)</span> <span style="color:#66d9ef">int</span> id<span style="color:#f92672">);</span>
<span style="color:#75715e">//键值对 对应 属性=属性值
</span></code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;!--Map&lt;String, Object&gt; getUserToMap(@Param(&#34;id&#34;) int id);--&gt;</span>
<span style="color:#f92672">&lt;select</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;getUserToMap&#34;</span> <span style="color:#a6e22e">resultType=</span><span style="color:#e6db74">&#34;map&#34;</span><span style="color:#f92672">&gt;</span>
    select * from t_user where id = #{id}
<span style="color:#f92672">&lt;/select&gt;</span>
<span style="color:#75715e">&lt;!--结果：{password=123456, gender=男, id=1, age=23, username=admin}--&gt;</span>
</code></pre></div><h4 id="5-查询多条数据为map集合">5. 查询多条数据为map集合</h4>
<p><strong>方式一：</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">/**
</span><span style="color:#75715e">* 查询所有用户信息为map集合
</span><span style="color:#75715e">* @return
</span><span style="color:#75715e">* 将表中的数据以map集合的方式查询，一条数据对应一个map；若有多条数据，就会产生多个map集合，		此时可以将这些map放在一个list集合中获取
</span><span style="color:#75715e">*/</span>
List<span style="color:#f92672">&lt;</span>Map<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">,</span> Object<span style="color:#f92672">&gt;&gt;</span> <span style="color:#a6e22e">getAllUserToMap</span><span style="color:#f92672">();</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;!--Map&lt;String, Object&gt; getAllUserToMap();--&gt;</span>
<span style="color:#f92672">&lt;select</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;getAllUserToMap&#34;</span> <span style="color:#a6e22e">resultType=</span><span style="color:#e6db74">&#34;map&#34;</span><span style="color:#f92672">&gt;</span>
    select * from t_user
<span style="color:#f92672">&lt;/select&gt;</span>
</code></pre></div><p><strong>方式二：</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">/**
</span><span style="color:#75715e">* 查询所有用户信息为map集合
</span><span style="color:#75715e">* @return
</span><span style="color:#75715e">* 将表中的数据以map集合的方式查询，一条数据对应一个map；若有多条数据，就会产生多个map集合，并且最终要以一个map的方式返回数据，此时需要通过@MapKey注解设置map集合的键，值是每条数据所对应的map集合
</span><span style="color:#75715e">*/</span>
<span style="color:#a6e22e">@MapKey</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;id&#34;</span><span style="color:#f92672">)</span>
Map<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">,</span> Object<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">getAllUserToMap</span><span style="color:#f92672">();</span>
<span style="color:#75715e">//查询出来的每一条数据会保存在Object中，并且其中的id属性会作为键存储
</span></code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;!--Map&lt;String, Object&gt; getAllUserToMap();--&gt;</span>
<span style="color:#f92672">&lt;select</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;getAllUserToMap&#34;</span> <span style="color:#a6e22e">resultType=</span><span style="color:#e6db74">&#34;map&#34;</span><span style="color:#f92672">&gt;</span>
    select * from t_user
<span style="color:#f92672">&lt;/select&gt;</span>
结果：
<span style="color:#75715e">&lt;!--
</span><span style="color:#75715e">4={password=qwert, gender=男, id=4, age=23, email=JY@123.com, username=Jamyoung}
</span><span style="color:#75715e">6={password=1457345, gender=男, id=6, age=23, email=sb@123.com, username=somebody}
</span><span style="color:#75715e">7={password=1457345, gender=男, id=7, age=23, email=admin@123.com, username=admin}
</span><span style="color:#75715e">8={password=JameTime, gender=男, id=8, age=24, email=jt@123.com, username=Jame}
</span><span style="color:#75715e">9={password=12345, gender=男, id=9, age=24, email=sp@123.com, username=Simple}
</span><span style="color:#75715e">10={password=SomeDieYoung, gender=男, id=10, age=24, email=sdy@123.com, username=sdy}
</span><span style="color:#75715e">11={password=FuckTheWorld, gender=男, id=11, age=24, email=rt@123.com, username=日天}
</span><span style="color:#75715e">12={password=Zhejiushi18, gender=女, id=12, age=24, email=zxc@123.com, username=&gt;_&lt;}
</span><span style="color:#75715e">13={password=tgwerfsdrf, gender=女, id=13, age=24, email=wer@123.com, username=what}
</span><span style="color:#75715e">--&gt;</span>

</code></pre></div><hr>
<hr>
<p><a id="SpecialSQL">#</a></p>
<h3 id="六特殊sql的执行">六、特殊SQL的执行</h3>
<h4 id="1-模糊查询">1. 模糊查询</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;!--List&lt;User&gt; getUserByLike(@Param(&#34;pattern&#34;) String pattern);--&gt;</span>
<span style="color:#f92672">&lt;select</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;getUserByLike&#34;</span> <span style="color:#a6e22e">resultType=</span><span style="color:#e6db74">&#34;User&#34;</span><span style="color:#f92672">&gt;</span>
    <span style="color:#75715e">&lt;!--select * from t_user where username like &#39;%${pattern}%&#39;--&gt;</span>
    <span style="color:#75715e">&lt;!--select * from t_user where username like concat(&#39;%&#39;,#{pattern},&#39;%&#39;)--&gt;</span>
    select * from t_user where username like &#34;%&#34;#{pattern}&#34;%&#34;
<span style="color:#f92672">&lt;/select&gt;</span>
</code></pre></div><h4 id="2-批量删除">2. 批量删除</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;!--int deleteMore(@Param(&#34;ids&#34;) String ids);--&gt;</span>
<span style="color:#f92672">&lt;delete</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;deleteMore&#34;</span><span style="color:#f92672">&gt;</span>
    delete from t_user where id in (${ids})
    <span style="color:#75715e">&lt;!--因为#{}会自动添加&#39;&#39;，所以此处只能使用${}--&gt;</span>
<span style="color:#f92672">&lt;/delete&gt;</span>
</code></pre></div><h4 id="3-动态设置表名">3. 动态设置表名</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;!--List&lt;User&gt; getAllUser(@Param(&#34;tableName&#34;) String tableName);--&gt;</span>
<span style="color:#f92672">&lt;select</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;getAllUser&#34;</span> <span style="color:#a6e22e">resultType=</span><span style="color:#e6db74">&#34;User&#34;</span><span style="color:#f92672">&gt;</span>
    select * from ${tableName}
<span style="color:#f92672">&lt;/select&gt;</span>
</code></pre></div><h4 id="4-添加功能获取自增的主键">4. 添加功能获取自增的主键</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">/**
</span><span style="color:#75715e">* 添加用户信息
</span><span style="color:#75715e">* @param user
</span><span style="color:#75715e">* @return
</span><span style="color:#75715e">* useGeneratedKeys：设置使用自增的主键
</span><span style="color:#75715e">* keyProperty：因为增删改有统一的返回值是受影响的行数，因此只能将获取的自增的主键放在传输的参数user对象的某个属性中
</span><span style="color:#75715e">*/</span>
<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">insertUser</span><span style="color:#f92672">(</span>User user<span style="color:#f92672">);</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;!--int insertUser(User user);--&gt;</span>
<span style="color:#f92672">&lt;insert</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;insertUser&#34;</span> <span style="color:#a6e22e">useGeneratedKeys=</span><span style="color:#e6db74">&#34;true&#34;</span> <span style="color:#a6e22e">keyProperty=</span><span style="color:#e6db74">&#34;id&#34;</span><span style="color:#f92672">&gt;</span>
    insert into t_user values(null,#{username},#{password},#{age},#{sex})
<span style="color:#f92672">&lt;/insert&gt;</span>
</code></pre></div><hr>
<hr>
<p><a id="resultMap">#</a></p>
<h3 id="七自定义映射resultmap">七、自定义映射resultMap</h3>
<h4 id="1-resultmap处理字段和属性的映射关系">1. resultMap处理字段和属性的映射关系</h4>
<p>若字段名和实体类中的属性名不一致，则可以通过resultMap设置自定义映射</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;!--
</span><span style="color:#75715e">    resultMap：设置自定义映射
</span><span style="color:#75715e">    属性：
</span><span style="color:#75715e">        id：表示自定义映射的唯一标识
</span><span style="color:#75715e">        type：查询的数据要映射的实体类的类型
</span><span style="color:#75715e">    子标签：
</span><span style="color:#75715e">        id：设置主键的映射关系
</span><span style="color:#75715e">        result：设置普通字段的映射关系
</span><span style="color:#75715e">        association：设置多对一的映射关系
</span><span style="color:#75715e">        collection：设置一对多的映射关系
</span><span style="color:#75715e">        属性：
</span><span style="color:#75715e">            property：设置映射关系中实体类中的属性名
</span><span style="color:#75715e">            column：设置映射关系中表中的字段名
</span><span style="color:#75715e">--&gt;</span>
<span style="color:#f92672">&lt;resultMap</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;userMap&#34;</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;User&#34;</span><span style="color:#f92672">&gt;</span>
    <span style="color:#f92672">&lt;id</span> <span style="color:#a6e22e">property=</span><span style="color:#e6db74">&#34;id&#34;</span> <span style="color:#a6e22e">column=</span><span style="color:#e6db74">&#34;id&#34;</span><span style="color:#f92672">&gt;&lt;/id&gt;</span><span style="color:#75715e">&lt;!--主键--&gt;</span>
    <span style="color:#f92672">&lt;result</span> <span style="color:#a6e22e">property=</span><span style="color:#e6db74">&#34;userName&#34;</span> <span style="color:#a6e22e">column=</span><span style="color:#e6db74">&#34;user_name&#34;</span><span style="color:#f92672">&gt;&lt;/result&gt;</span>
    <span style="color:#f92672">&lt;result</span> <span style="color:#a6e22e">property=</span><span style="color:#e6db74">&#34;password&#34;</span> <span style="color:#a6e22e">column=</span><span style="color:#e6db74">&#34;password&#34;</span><span style="color:#f92672">&gt;&lt;/result&gt;</span>
    <span style="color:#f92672">&lt;result</span> <span style="color:#a6e22e">property=</span><span style="color:#e6db74">&#34;age&#34;</span> <span style="color:#a6e22e">column=</span><span style="color:#e6db74">&#34;age&#34;</span><span style="color:#f92672">&gt;&lt;/result&gt;</span>
    <span style="color:#f92672">&lt;result</span> <span style="color:#a6e22e">property=</span><span style="color:#e6db74">&#34;gender&#34;</span> <span style="color:#a6e22e">column=</span><span style="color:#e6db74">&#34;gender&#34;</span><span style="color:#f92672">&gt;&lt;/result&gt;</span>
<span style="color:#f92672">&lt;/resultMap&gt;</span>

<span style="color:#75715e">&lt;!--List&lt;User&gt; testMohu(@Param(&#34;mohu&#34;) String mohu);--&gt;</span>
<span style="color:#f92672">&lt;select</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;testMohu&#34;</span> <span style="color:#a6e22e">resultMap=</span><span style="color:#e6db74">&#34;userMap&#34;</span><span style="color:#f92672">&gt;</span>
    <span style="color:#75715e">&lt;!--select * from t_user where username like &#39;%${mohu}%&#39;--&gt;</span>
    select id,user_name,password,age,gender from t_user where user_name like
    concat(&#39;%&#39;,#{mohu},&#39;%&#39;)
<span style="color:#f92672">&lt;/select&gt;</span>
</code></pre></div><p>若字段名和实体类中的属性名不一致，但是字段名符合数据库的规则（使用_），实体类中的属性名符合Java的规则（使用驼峰）</p>
<p>此时也可通过以下两种方式处理字段名和实体类中的属性的映射关系</p>
<p><strong>a&gt;可以通过为字段起别名的方式，保证和实体类中的属性名保持一致</strong></p>
<p><strong>b&gt;可以在MyBatis的核心配置文件中设置一个全局配置信息mapUnderscoreToCamelCase，可以在查询表中数据时，自动将_类型的字段名转换为驼峰</strong></p>
<p>例如：字段名user_name，设置了mapUnderscoreToCamelCase，此时字段名就会转换为 userName</p>
<h4 id="2-多对一映射处理">2. 多对一映射处理</h4>
<p>以 员工信息以及员工所对应的部门信息 为例</p>
<p><strong>a&gt;级联方式处理映射关系</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;!--List&lt;Emp&gt; getAllEmps();--&gt;</span>
<span style="color:#f92672">&lt;select</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;getAllEmps&#34;</span> <span style="color:#a6e22e">resultMap=</span><span style="color:#e6db74">&#34;EmpRM&#34;</span><span style="color:#f92672">&gt;</span>
    select * from t_emp left join t_dept on t_emp.did = t_dept.did
<span style="color:#f92672">&lt;/select&gt;</span>
<span style="color:#75715e">&lt;!--select emp.*,dept.* from t_emp emp left join t_dept dept on emp.did = dept.did--&gt;</span>
<span style="color:#f92672">&lt;resultMap</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;EmpRM&#34;</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;Emp&#34;</span><span style="color:#f92672">&gt;</span>
    <span style="color:#f92672">&lt;id</span> <span style="color:#a6e22e">property=</span><span style="color:#e6db74">&#34;eid&#34;</span> <span style="color:#a6e22e">column=</span><span style="color:#e6db74">&#34;eid&#34;</span><span style="color:#f92672">/&gt;</span>
    <span style="color:#f92672">&lt;result</span> <span style="color:#a6e22e">property=</span><span style="color:#e6db74">&#34;empName&#34;</span> <span style="color:#a6e22e">column=</span><span style="color:#e6db74">&#34;emp_name&#34;</span><span style="color:#f92672">/&gt;</span>
    <span style="color:#f92672">&lt;result</span> <span style="color:#a6e22e">property=</span><span style="color:#e6db74">&#34;age&#34;</span> <span style="color:#a6e22e">column=</span><span style="color:#e6db74">&#34;age&#34;</span><span style="color:#f92672">/&gt;</span>
    <span style="color:#f92672">&lt;result</span> <span style="color:#a6e22e">property=</span><span style="color:#e6db74">&#34;gender&#34;</span> <span style="color:#a6e22e">column=</span><span style="color:#e6db74">&#34;gender&#34;</span><span style="color:#f92672">/&gt;</span>
    <span style="color:#f92672">&lt;result</span> <span style="color:#a6e22e">property=</span><span style="color:#e6db74">&#34;email&#34;</span> <span style="color:#a6e22e">column=</span><span style="color:#e6db74">&#34;email&#34;</span><span style="color:#f92672">/&gt;</span>
    <span style="color:#f92672">&lt;result</span> <span style="color:#a6e22e">property=</span><span style="color:#e6db74">&#34;dept.did&#34;</span> <span style="color:#a6e22e">column=</span><span style="color:#e6db74">&#34;did&#34;</span><span style="color:#f92672">/&gt;</span>
    <span style="color:#f92672">&lt;result</span> <span style="color:#a6e22e">property=</span><span style="color:#e6db74">&#34;dept.deptName&#34;</span> <span style="color:#a6e22e">column=</span><span style="color:#e6db74">&#34;dept_name&#34;</span><span style="color:#f92672">/&gt;</span>
<span style="color:#f92672">&lt;/resultMap&gt;</span>
</code></pre></div><p><strong>b&gt;使用association处理映射关系</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;!--List&lt;Emp&gt; getAllEmps();--&gt;</span>
<span style="color:#f92672">&lt;select</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;getAllEmps&#34;</span> <span style="color:#a6e22e">resultMap=</span><span style="color:#e6db74">&#34;EmpRM&#34;</span><span style="color:#f92672">&gt;</span>
    select * from t_emp left join t_dept on t_emp.did = t_dept.did
<span style="color:#f92672">&lt;/select&gt;</span>
<span style="color:#75715e">&lt;!--select emp.*,dept.* from t_emp emp left join t_dept dept on emp.did = dept.did--&gt;</span>
<span style="color:#f92672">&lt;resultMap</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;EmpRM&#34;</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;Emp&#34;</span><span style="color:#f92672">&gt;</span>
    <span style="color:#f92672">&lt;id</span> <span style="color:#a6e22e">property=</span><span style="color:#e6db74">&#34;eid&#34;</span> <span style="color:#a6e22e">column=</span><span style="color:#e6db74">&#34;eid&#34;</span><span style="color:#f92672">/&gt;</span>
    <span style="color:#f92672">&lt;result</span> <span style="color:#a6e22e">property=</span><span style="color:#e6db74">&#34;empName&#34;</span> <span style="color:#a6e22e">column=</span><span style="color:#e6db74">&#34;emp_name&#34;</span><span style="color:#f92672">/&gt;</span>
    <span style="color:#f92672">&lt;result</span> <span style="color:#a6e22e">property=</span><span style="color:#e6db74">&#34;age&#34;</span> <span style="color:#a6e22e">column=</span><span style="color:#e6db74">&#34;age&#34;</span><span style="color:#f92672">/&gt;</span>
    <span style="color:#f92672">&lt;result</span> <span style="color:#a6e22e">property=</span><span style="color:#e6db74">&#34;gender&#34;</span> <span style="color:#a6e22e">column=</span><span style="color:#e6db74">&#34;gender&#34;</span><span style="color:#f92672">/&gt;</span>
    <span style="color:#f92672">&lt;result</span> <span style="color:#a6e22e">property=</span><span style="color:#e6db74">&#34;email&#34;</span> <span style="color:#a6e22e">column=</span><span style="color:#e6db74">&#34;email&#34;</span><span style="color:#f92672">/&gt;</span>
    <span style="color:#f92672">&lt;association</span> <span style="color:#a6e22e">property=</span><span style="color:#e6db74">&#34;dept&#34;</span> <span style="color:#a6e22e">javaType=</span><span style="color:#e6db74">&#34;Dept&#34;</span><span style="color:#f92672">&gt;</span>
        <span style="color:#f92672">&lt;id</span> <span style="color:#a6e22e">property=</span><span style="color:#e6db74">&#34;did&#34;</span> <span style="color:#a6e22e">column=</span><span style="color:#e6db74">&#34;did&#34;</span><span style="color:#f92672">/&gt;</span>
        <span style="color:#f92672">&lt;result</span> <span style="color:#a6e22e">property=</span><span style="color:#e6db74">&#34;deptName&#34;</span> <span style="color:#a6e22e">column=</span><span style="color:#e6db74">&#34;dept_name&#34;</span><span style="color:#f92672">/&gt;</span>
    <span style="color:#f92672">&lt;/association&gt;</span>
<span style="color:#f92672">&lt;/resultMap&gt;</span>
</code></pre></div><p><strong>c&gt;分步查询</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;!--EmpMapper.xml--&gt;</span>

<span style="color:#75715e">&lt;!--Emp getEmpById(@Param(&#34;eid&#34;) Integer eid);--&gt;</span>
<span style="color:#f92672">&lt;select</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;getEmpById&#34;</span> <span style="color:#a6e22e">resultMap=</span><span style="color:#e6db74">&#34;getEmpAndDeptByStep&#34;</span><span style="color:#f92672">&gt;</span>
    select * from t_emp where eid = #{eid}
<span style="color:#f92672">&lt;/select&gt;</span>

<span style="color:#f92672">&lt;resultMap</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;getEmpAndDeptByStep&#34;</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;Emp&#34;</span><span style="color:#f92672">&gt;</span>
    <span style="color:#f92672">&lt;id</span> <span style="color:#a6e22e">property=</span><span style="color:#e6db74">&#34;eid&#34;</span> <span style="color:#a6e22e">column=</span><span style="color:#e6db74">&#34;eid&#34;</span><span style="color:#f92672">/&gt;</span>
    <span style="color:#f92672">&lt;result</span> <span style="color:#a6e22e">property=</span><span style="color:#e6db74">&#34;empName&#34;</span> <span style="color:#a6e22e">column=</span><span style="color:#e6db74">&#34;emp_name&#34;</span><span style="color:#f92672">/&gt;</span>
    <span style="color:#f92672">&lt;result</span> <span style="color:#a6e22e">property=</span><span style="color:#e6db74">&#34;age&#34;</span> <span style="color:#a6e22e">column=</span><span style="color:#e6db74">&#34;age&#34;</span><span style="color:#f92672">/&gt;</span>
    <span style="color:#f92672">&lt;result</span> <span style="color:#a6e22e">property=</span><span style="color:#e6db74">&#34;gender&#34;</span> <span style="color:#a6e22e">column=</span><span style="color:#e6db74">&#34;gender&#34;</span><span style="color:#f92672">/&gt;</span>
    <span style="color:#f92672">&lt;result</span> <span style="color:#a6e22e">property=</span><span style="color:#e6db74">&#34;email&#34;</span> <span style="color:#a6e22e">column=</span><span style="color:#e6db74">&#34;email&#34;</span><span style="color:#f92672">/&gt;</span>
    <span style="color:#f92672">&lt;association</span> <span style="color:#a6e22e">property=</span><span style="color:#e6db74">&#34;dept&#34;</span>
                 <span style="color:#a6e22e">select=</span><span style="color:#e6db74">&#34;com.sherry.mybatis.mapper.DeptMapper.getDeptById&#34;</span>
                 <span style="color:#a6e22e">column=</span><span style="color:#e6db74">&#34;did&#34;</span><span style="color:#f92672">/&gt;</span>
    <span style="color:#75715e">&lt;!--
</span><span style="color:#75715e">		property：属性名  
</span><span style="color:#75715e">		select：设置分步查询，查询某个属性的值的sql的标识（namespace.sqlId）
</span><span style="color:#75715e">		column：将sql以及查询结果中的某个字段设置为分步查询的条件
</span><span style="color:#75715e">	--&gt;</span>
<span style="color:#f92672">&lt;/resultMap&gt;</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;!--DeptMapper.xml--&gt;</span>

<span style="color:#75715e">&lt;!--Dept getDeptById(@Param(&#34;did&#34;) Integer did);--&gt;</span>
<span style="color:#f92672">&lt;select</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;getDeptById&#34;</span> <span style="color:#a6e22e">resultType=</span><span style="color:#e6db74">&#34;Dept&#34;</span><span style="color:#f92672">&gt;</span>
    select * from t_dept where did = #{did}
<span style="color:#f92672">&lt;/select&gt;</span>
</code></pre></div><h4 id="3-一对多映射处理">3. 一对多映射处理</h4>
<p><strong>a&gt;collection</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;!--Dept getEmps(@Param(&#34;did&#34;) Integer did);--&gt;</span>
<span style="color:#f92672">&lt;select</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;getEmps&#34;</span> <span style="color:#a6e22e">resultMap=</span><span style="color:#e6db74">&#34;deptEmpRM&#34;</span><span style="color:#f92672">&gt;</span>
    select * from t_dept left join t_emp on t_dept.did = t_emp.did where t_dept.did = #{did}
<span style="color:#f92672">&lt;/select&gt;</span>

<span style="color:#f92672">&lt;resultMap</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;deptEmpRM&#34;</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;Dept&#34;</span><span style="color:#f92672">&gt;</span>
    <span style="color:#f92672">&lt;id</span> <span style="color:#a6e22e">property=</span><span style="color:#e6db74">&#34;did&#34;</span> <span style="color:#a6e22e">column=</span><span style="color:#e6db74">&#34;did&#34;</span><span style="color:#f92672">/&gt;</span>
    <span style="color:#f92672">&lt;result</span> <span style="color:#a6e22e">property=</span><span style="color:#e6db74">&#34;deptName&#34;</span> <span style="color:#a6e22e">column=</span><span style="color:#e6db74">&#34;dept_name&#34;</span><span style="color:#f92672">/&gt;</span>
    <span style="color:#f92672">&lt;collection</span> <span style="color:#a6e22e">property=</span><span style="color:#e6db74">&#34;emps&#34;</span> <span style="color:#a6e22e">ofType=</span><span style="color:#e6db74">&#34;Emp&#34;</span><span style="color:#f92672">&gt;</span>
        <span style="color:#f92672">&lt;id</span> <span style="color:#a6e22e">property=</span><span style="color:#e6db74">&#34;eid&#34;</span> <span style="color:#a6e22e">column=</span><span style="color:#e6db74">&#34;eid&#34;</span><span style="color:#f92672">/&gt;</span>
        <span style="color:#f92672">&lt;result</span> <span style="color:#a6e22e">property=</span><span style="color:#e6db74">&#34;empName&#34;</span> <span style="color:#a6e22e">column=</span><span style="color:#e6db74">&#34;emp_name&#34;</span><span style="color:#f92672">/&gt;</span>
        <span style="color:#f92672">&lt;result</span> <span style="color:#a6e22e">property=</span><span style="color:#e6db74">&#34;age&#34;</span> <span style="color:#a6e22e">column=</span><span style="color:#e6db74">&#34;age&#34;</span><span style="color:#f92672">/&gt;</span>
        <span style="color:#f92672">&lt;result</span> <span style="color:#a6e22e">property=</span><span style="color:#e6db74">&#34;gender&#34;</span> <span style="color:#a6e22e">column=</span><span style="color:#e6db74">&#34;gender&#34;</span><span style="color:#f92672">/&gt;</span>
        <span style="color:#f92672">&lt;result</span> <span style="color:#a6e22e">property=</span><span style="color:#e6db74">&#34;email&#34;</span> <span style="color:#a6e22e">column=</span><span style="color:#e6db74">&#34;email&#34;</span><span style="color:#f92672">/&gt;</span>
        <span style="color:#75715e">&lt;!--此处不再设置dept属性--&gt;</span>
    <span style="color:#f92672">&lt;/collection&gt;</span>
<span style="color:#f92672">&lt;/resultMap&gt;</span>
</code></pre></div><p><strong>b&gt;分步查询</strong></p>
<p>1）查询部门信息</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;!--Dept getDept(@Param(&#34;did&#34;) Integer did);--&gt;</span>
<span style="color:#f92672">&lt;select</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;getDept&#34;</span> <span style="color:#a6e22e">resultMap=</span><span style="color:#e6db74">&#34;deptEmpRM&#34;</span><span style="color:#f92672">&gt;</span>
    select * from t_dept where did = #{did}
<span style="color:#f92672">&lt;/select&gt;</span>

<span style="color:#f92672">&lt;resultMap</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;deptEmpRM&#34;</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;Dept&#34;</span><span style="color:#f92672">&gt;</span>
    <span style="color:#f92672">&lt;id</span> <span style="color:#a6e22e">property=</span><span style="color:#e6db74">&#34;did&#34;</span> <span style="color:#a6e22e">column=</span><span style="color:#e6db74">&#34;did&#34;</span><span style="color:#f92672">/&gt;</span>
    <span style="color:#f92672">&lt;result</span> <span style="color:#a6e22e">property=</span><span style="color:#e6db74">&#34;deptName&#34;</span> <span style="color:#a6e22e">column=</span><span style="color:#e6db74">&#34;dept_name&#34;</span><span style="color:#f92672">/&gt;</span>
    <span style="color:#f92672">&lt;collection</span> <span style="color:#a6e22e">property=</span><span style="color:#e6db74">&#34;emps&#34;</span>
                <span style="color:#a6e22e">select=</span><span style="color:#e6db74">&#34;com.sherry.mybatis.mapper.EmpMapper.getEmpsByDid&#34;</span>
                <span style="color:#a6e22e">column=</span><span style="color:#e6db74">&#34;did&#34;</span>
                <span style="color:#a6e22e">fetchType=</span><span style="color:#e6db74">&#34;eager&#34;</span><span style="color:#f92672">&gt;</span>

    <span style="color:#f92672">&lt;/collection&gt;</span>
<span style="color:#f92672">&lt;/resultMap&gt;</span>
</code></pre></div><p>2）根据部门id查询部门中的所有员工</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;!--List&lt;Emp&gt; getEmpsByDid(@Param(&#34;did&#34;) Integer did);--&gt;</span>
<span style="color:#f92672">&lt;select</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;getEmpsByDid&#34;</span> <span style="color:#a6e22e">resultType=</span><span style="color:#e6db74">&#34;Emp&#34;</span><span style="color:#f92672">&gt;</span>
    select * from t_emp where did = #{did}
<span style="color:#f92672">&lt;/select&gt;</span>
</code></pre></div><p>分布查询的优点：可以实现延迟加载，但是必须在核心配置文件中设置全局配置信息(settings)或者在标签中设置属性fetchType为lazy</p>
<p><strong>settings:</strong></p>
<p>azyLoadingEnabled(默认false)：延迟加载的全局开关。当开启时，所有关联对象都会延迟加载</p>
<p>aggressiveLazyLoading(默认false)：当开启时，任何方法的调用都会加载该对象的所有属性。 否则，每个属性会按需加载</p>
<p>此时就可以实现按需加载，获取的数据是什么，就只会执行相应的sql。此时可通过association和 collection中的fetchType属性设置当前的分步查询是否使用延迟加载，fetchType=&ldquo;lazy(延迟加载)|eager(立即加载)&rdquo;</p>
<hr>
<hr>
<p><a id="DynamicSQL">#</a></p>
<h3 id="八动态sql">八、动态SQL</h3>
<p>Mybatis框架的动态SQL技术是一种根据特定条件动态拼装SQL语句的功能，它存在的意义是为了解决拼接SQL语句字符串时的痛点问题。</p>
<h4 id="1-if">1. if</h4>
<p>if标签可通过test属性的表达式进行判断，若表达式的结果为true，则标签中的内容会执行；反之标签中的内容不会执行</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;!--List&lt;Emp&gt; getEmpByCondition(Emp emp);--&gt;</span>
<span style="color:#f92672">&lt;select</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;getEmpByCondition&#34;</span> <span style="color:#a6e22e">resultType=</span><span style="color:#e6db74">&#34;Emp&#34;</span><span style="color:#f92672">&gt;</span>
    select * from t_emp where 1=1
    <span style="color:#f92672">&lt;if</span> <span style="color:#a6e22e">test=</span><span style="color:#e6db74">&#34;empName != null and empName != &#39;&#39;&#34;</span><span style="color:#f92672">&gt;</span>
        and emp_name = #{empName}
    <span style="color:#f92672">&lt;/if&gt;</span>
    <span style="color:#f92672">&lt;if</span> <span style="color:#a6e22e">test=</span><span style="color:#e6db74">&#34;age != null and age != &#39;&#39;&#34;</span><span style="color:#f92672">&gt;</span>
        and age = #{age}
    <span style="color:#f92672">&lt;/if&gt;</span>
    <span style="color:#f92672">&lt;if</span> <span style="color:#a6e22e">test=</span><span style="color:#e6db74">&#34;gender != null and gender != &#39;&#39;&#34;</span><span style="color:#f92672">&gt;</span>
        and gender = #{gender}
    <span style="color:#f92672">&lt;/if&gt;</span>
    <span style="color:#f92672">&lt;if</span> <span style="color:#a6e22e">test=</span><span style="color:#e6db74">&#34;email != null and email != &#39;&#39;&#34;</span><span style="color:#f92672">&gt;</span>
        and email = #{email}
    <span style="color:#f92672">&lt;/if&gt;</span>

<span style="color:#f92672">&lt;/select&gt;</span>
</code></pre></div><h4 id="2-where">2. where</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;!--List&lt;Emp&gt; getEmpByCondition(Emp emp);--&gt;</span>
<span style="color:#f92672">&lt;select</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;getEmpByCondition&#34;</span> <span style="color:#a6e22e">resultType=</span><span style="color:#e6db74">&#34;Emp&#34;</span><span style="color:#f92672">&gt;</span>
    select * from t_emp
    <span style="color:#f92672">&lt;where&gt;</span>
        <span style="color:#f92672">&lt;if</span> <span style="color:#a6e22e">test=</span><span style="color:#e6db74">&#34;empName != null and empName != &#39;&#39;&#34;</span><span style="color:#f92672">&gt;</span>
            and emp_name = #{empName}
        <span style="color:#f92672">&lt;/if&gt;</span>
        <span style="color:#f92672">&lt;if</span> <span style="color:#a6e22e">test=</span><span style="color:#e6db74">&#34;age != null and age != &#39;&#39;&#34;</span><span style="color:#f92672">&gt;</span>
            and age = #{age}
        <span style="color:#f92672">&lt;/if&gt;</span>
        <span style="color:#f92672">&lt;if</span> <span style="color:#a6e22e">test=</span><span style="color:#e6db74">&#34;gender != null and gender != &#39;&#39;&#34;</span><span style="color:#f92672">&gt;</span>
            and gender = #{gender}
        <span style="color:#f92672">&lt;/if&gt;</span>
        <span style="color:#f92672">&lt;if</span> <span style="color:#a6e22e">test=</span><span style="color:#e6db74">&#34;email != null and email != &#39;&#39;&#34;</span><span style="color:#f92672">&gt;</span>
            and email = #{email}
        <span style="color:#f92672">&lt;/if&gt;</span>
    <span style="color:#f92672">&lt;/where&gt;</span>

<span style="color:#f92672">&lt;/select&gt;</span>
</code></pre></div><p>where和if一般结合使用：</p>
<p><strong>a&gt;若where标签中的if条件都不满足，则where标签没有任何功能，即不会添加where关键字</strong></p>
<p><strong>b&gt;若where标签中的if条件满足，则where标签会自动添加where关键字，并将条件前方多余的and或or去掉</strong></p>
<p><strong>注意：where标签不能去掉条件后多余的and</strong></p>
<h4 id="3-trim">3. trim</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;!--List&lt;Emp&gt; getEmpByCondition(Emp emp);--&gt;</span>
<span style="color:#f92672">&lt;select</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;getEmpByCondition&#34;</span> <span style="color:#a6e22e">resultType=</span><span style="color:#e6db74">&#34;Emp&#34;</span><span style="color:#f92672">&gt;</span>
    select * from t_emp
    
    <span style="color:#f92672">&lt;trim</span> <span style="color:#a6e22e">prefix=</span><span style="color:#e6db74">&#34;where&#34;</span> <span style="color:#a6e22e">suffixOverrides=</span><span style="color:#e6db74">&#34;and|or&#34;</span><span style="color:#f92672">&gt;</span>
        <span style="color:#f92672">&lt;if</span> <span style="color:#a6e22e">test=</span><span style="color:#e6db74">&#34;empName != null and empName != &#39;&#39;&#34;</span><span style="color:#f92672">&gt;</span>
            emp_name = #{empName} and
        <span style="color:#f92672">&lt;/if&gt;</span>
        <span style="color:#f92672">&lt;if</span> <span style="color:#a6e22e">test=</span><span style="color:#e6db74">&#34;age != null and age != &#39;&#39;&#34;</span><span style="color:#f92672">&gt;</span>
            age = #{age} or
        <span style="color:#f92672">&lt;/if&gt;</span>
        <span style="color:#f92672">&lt;if</span> <span style="color:#a6e22e">test=</span><span style="color:#e6db74">&#34;gender != null and gender != &#39;&#39;&#34;</span><span style="color:#f92672">&gt;</span>
            gender = #{gender} and
        <span style="color:#f92672">&lt;/if&gt;</span>
        <span style="color:#f92672">&lt;if</span> <span style="color:#a6e22e">test=</span><span style="color:#e6db74">&#34;email != null and email != &#39;&#39;&#34;</span><span style="color:#f92672">&gt;</span>
            email = #{email}
        <span style="color:#f92672">&lt;/if&gt;</span>
    <span style="color:#f92672">&lt;/trim&gt;</span>
    
<span style="color:#f92672">&lt;/select&gt;</span>
</code></pre></div><p>trim用于去掉或添加标签中的内容</p>
<p>常用属性：</p>
<p>prefix：在trim标签中的内容的前面添加某些内容</p>
<p>prefixOverrides：去掉trim标签中内容的前面的某些内容</p>
<p>suffix：在trim标签中的内容的后面添加某些内容</p>
<p>suffixOverrides：去掉trim标签中内容的后面的某些内容</p>
<h4 id="4-choosewhenotherwise">4. choose、when、otherwise</h4>
<p>choose、when、otherwise相当于if&hellip;else if..else</p>
<p>只会执行第一个满足条件的when标签中的sql</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;!--List&lt;Emp&gt; getEmpListByChoose(Emp emp);--&gt;</span>
<span style="color:#f92672">&lt;select</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;getEmpListByChoose&#34;</span> <span style="color:#a6e22e">resultType=</span><span style="color:#e6db74">&#34;Emp&#34;</span><span style="color:#f92672">&gt;</span>
    select * from t_emp
    <span style="color:#f92672">&lt;where&gt;</span>
        <span style="color:#f92672">&lt;choose&gt;</span>
            <span style="color:#f92672">&lt;when</span> <span style="color:#a6e22e">test=</span><span style="color:#e6db74">&#34;empName != &#39;&#39; and empName != null&#34;</span><span style="color:#f92672">&gt;</span>
                emp_name = #{empName}
            <span style="color:#f92672">&lt;/when&gt;</span>
            <span style="color:#f92672">&lt;when</span> <span style="color:#a6e22e">test=</span><span style="color:#e6db74">&#34;age != &#39;&#39; and age != null&#34;</span><span style="color:#f92672">&gt;</span>
                age = #{age}
            <span style="color:#f92672">&lt;/when&gt;</span>
            <span style="color:#f92672">&lt;when</span> <span style="color:#a6e22e">test=</span><span style="color:#e6db74">&#34;gender != &#39;&#39; and gender != null&#34;</span><span style="color:#f92672">&gt;</span>
                gender = #{gender}
            <span style="color:#f92672">&lt;/when&gt;</span>
            <span style="color:#f92672">&lt;when</span> <span style="color:#a6e22e">test=</span><span style="color:#e6db74">&#34;email != &#39;&#39; and email != null&#34;</span><span style="color:#f92672">&gt;</span>
                email = #{email}
            <span style="color:#f92672">&lt;/when&gt;</span>
            <span style="color:#f92672">&lt;otherwise&gt;</span>
                did = 1
            <span style="color:#f92672">&lt;/otherwise&gt;</span>
        <span style="color:#f92672">&lt;/choose&gt;</span>
    <span style="color:#f92672">&lt;/where&gt;</span>
<span style="color:#f92672">&lt;/select&gt;</span>
</code></pre></div><h4 id="5-foreach">5. foreach</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;!--int deleteMultiEmps(@Param(&#34;eids&#34;) Integer[] eids);--&gt;</span>
<span style="color:#f92672">&lt;delete</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;deleteMultiEmps&#34;</span><span style="color:#f92672">&gt;</span>
    delete from t_emp where eid in
    <span style="color:#f92672">&lt;foreach</span> <span style="color:#a6e22e">collection=</span><span style="color:#e6db74">&#34;eids&#34;</span> <span style="color:#a6e22e">item=</span><span style="color:#e6db74">&#34;eid&#34;</span> <span style="color:#a6e22e">separator=</span><span style="color:#e6db74">&#34;,&#34;</span> <span style="color:#a6e22e">open=</span><span style="color:#e6db74">&#34;(&#34;</span> <span style="color:#a6e22e">close=</span><span style="color:#e6db74">&#34;)&#34;</span><span style="color:#f92672">&gt;</span>
        #{eid}
    <span style="color:#f92672">&lt;/foreach&gt;</span>
<span style="color:#f92672">&lt;/delete&gt;</span>

<span style="color:#75715e">&lt;!--int addMultiEmps(@Param(&#34;emps&#34;) List&lt;Emp&gt; emps);--&gt;</span>
<span style="color:#f92672">&lt;insert</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;addMultiEmps&#34;</span><span style="color:#f92672">&gt;</span>
    insert into t_emp values
    <span style="color:#f92672">&lt;foreach</span> <span style="color:#a6e22e">collection=</span><span style="color:#e6db74">&#34;emps&#34;</span> <span style="color:#a6e22e">item=</span><span style="color:#e6db74">&#34;emp&#34;</span> <span style="color:#a6e22e">separator=</span><span style="color:#e6db74">&#34;,&#34;</span><span style="color:#f92672">&gt;</span>
        (null, #{emp.empName}, #{emp.age}, #{emp.gender}, #{emp.email}, null)
    <span style="color:#f92672">&lt;/foreach&gt;</span>
<span style="color:#f92672">&lt;/insert&gt;</span>
</code></pre></div><p><strong>属性：</strong></p>
<p><strong>collection：设置要循环的数组或集合</strong></p>
<p><strong>item：表示集合或数组中的每一个数据</strong></p>
<p><strong>separator：设置循环体之间的分隔符</strong></p>
<p><strong>open：设置foreach标签中的内容的开始符</strong></p>
<p><strong>close：设置foreach标签中的内容的结束符</strong></p>
<h4 id="6-sql片段">6. SQL片段</h4>
<p>sql片段，可以记录一段公共sql片段，在使用的地方通过include标签进行引入</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#f92672">&lt;sql</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#34;empColumns&#34;</span><span style="color:#f92672">&gt;</span>
    eid,ename,age,sex,did
<span style="color:#f92672">&lt;/sql&gt;</span>

select <span style="color:#f92672">&lt;include</span> <span style="color:#a6e22e">refid=</span><span style="color:#e6db74">&#34;empColumns&#34;</span><span style="color:#f92672">&gt;&lt;/include&gt;</span> from t_emp
</code></pre></div>
    </div>
    <div class="post-footer">
      
    </div>
  </article>

    </main>
  </body>
</html>
